{"ast":null,"code":"var _jsxFileName = \"C:\\\\projects\\\\react_todo-app-with-api\\\\src\\\\components\\\\Auth\\\\AuthForm.tsx\",\n  _s = $RefreshSig$();\nimport classNames from 'classnames';\nimport React, { useEffect, useState } from 'react';\nimport { createUser, getUserByEmail } from '../../api/users';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport const AuthForm = _ref => {\n  _s();\n  let {\n    onLogin\n  } = _ref;\n  const [email, setEmail] = useState('');\n  const [name, setName] = useState('');\n  const [needToRegister, setNeedToRegister] = useState(false);\n  const [loading, setLoading] = useState(false);\n  const [errorMessage, setErrorMessage] = useState('');\n  const saveUser = user => {\n    localStorage.setItem('user', JSON.stringify(user));\n    onLogin(user);\n  };\n  useEffect(() => {\n    const userData = localStorage.getItem('user');\n    if (!userData) {\n      return;\n    }\n    try {\n      const user = JSON.parse(userData);\n      onLogin(user);\n    } catch (error) {\n      // Need to login\n    }\n  }, []);\n  const loadUser = async () => {\n    const user = await getUserByEmail(email);\n    if (user) {\n      saveUser(user);\n    } else {\n      setNeedToRegister(true);\n    }\n  };\n  const registerUser = () => {\n    return createUser({\n      name,\n      email\n    }).then(saveUser);\n  };\n  const handleSubmit = async event => {\n    event.preventDefault();\n    setErrorMessage('');\n    setLoading(true);\n    try {\n      if (needToRegister) {\n        await registerUser();\n      } else {\n        await loadUser();\n      }\n    } catch (error) {\n      setErrorMessage('Something went wrtong');\n    } finally {\n      setLoading(false);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"form\", {\n    onSubmit: handleSubmit,\n    className: \"box mt-5\",\n    children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n      className: \"title is-3\",\n      children: needToRegister ? 'You need to register' : 'Log in to open todos'\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 74,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"field\",\n      children: [/*#__PURE__*/_jsxDEV(\"label\", {\n        className: \"label\",\n        htmlFor: \"user-email\",\n        children: \"Email\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 79,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: classNames('control has-icons-left', {\n          'is-loading': loading\n        }),\n        children: [/*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"email\",\n          id: \"user-email\",\n          className: classNames('input', {\n            'is-danger': !needToRegister && errorMessage\n          }),\n          placeholder: \"Enter your email\",\n          disabled: loading || needToRegister,\n          value: email,\n          required: true,\n          onChange: e => setEmail(e.target.value)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 88,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"icon is-small is-left\",\n          children: /*#__PURE__*/_jsxDEV(\"i\", {\n            className: \"fas fa-envelope\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 102,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 101,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 83,\n        columnNumber: 9\n      }, this), !needToRegister && errorMessage && /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"help is-danger\",\n        children: errorMessage\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 107,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 78,\n      columnNumber: 7\n    }, this), needToRegister && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"field\",\n      children: [/*#__PURE__*/_jsxDEV(\"label\", {\n        className: \"label\",\n        htmlFor: \"user-name\",\n        children: \"Your Name\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 113,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: classNames('control has-icons-left', {\n          'is-loading': loading\n        }),\n        children: [/*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"text\",\n          id: \"user-name\",\n          className: classNames('input', {\n            'is-danger': needToRegister && errorMessage\n          }),\n          placeholder: \"Enter your name\",\n          required: true,\n          minLength: 4,\n          disabled: loading,\n          value: name,\n          onChange: e => setName(e.target.value)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 122,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"icon is-small is-left\",\n          children: /*#__PURE__*/_jsxDEV(\"i\", {\n            className: \"fas fa-user\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 137,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 136,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 117,\n        columnNumber: 11\n      }, this), needToRegister && errorMessage && /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"help is-danger\",\n        children: errorMessage\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 142,\n        columnNumber: 13\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 112,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"field\",\n      children: /*#__PURE__*/_jsxDEV(\"button\", {\n        type: \"submit\",\n        className: classNames('button is-primary', {\n          'is-loading': loading\n        }),\n        children: needToRegister ? 'Register' : 'Login'\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 148,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 147,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 73,\n    columnNumber: 5\n  }, this);\n};\n_s(AuthForm, \"tPIjNbskzau5AM9CD7eknfIxxw4=\");\n_c = AuthForm;\nvar _c;\n$RefreshReg$(_c, \"AuthForm\");","map":{"version":3,"names":["classNames","React","useEffect","useState","createUser","getUserByEmail","AuthForm","onLogin","email","setEmail","name","setName","needToRegister","setNeedToRegister","loading","setLoading","errorMessage","setErrorMessage","saveUser","user","localStorage","setItem","JSON","stringify","userData","getItem","parse","error","loadUser","registerUser","then","handleSubmit","event","preventDefault","e","target","value"],"sources":["C:/projects/react_todo-app-with-api/src/components/Auth/AuthForm.tsx"],"sourcesContent":["import classNames from 'classnames';\nimport React, { useEffect, useState } from 'react';\nimport { createUser, getUserByEmail } from '../../api/users';\nimport { User } from '../../types/User';\n\nexport type Props = {\n  onLogin: (user: User) => void,\n};\n\nexport const AuthForm: React.FC<Props> = ({ onLogin }) => {\n  const [email, setEmail] = useState('');\n  const [name, setName] = useState('');\n  const [needToRegister, setNeedToRegister] = useState(false);\n  const [loading, setLoading] = useState(false);\n  const [errorMessage, setErrorMessage] = useState('');\n\n  const saveUser = (user: User) => {\n    localStorage.setItem('user', JSON.stringify(user));\n    onLogin(user);\n  };\n\n  useEffect(() => {\n    const userData = localStorage.getItem('user');\n\n    if (!userData) {\n      return;\n    }\n\n    try {\n      const user = JSON.parse(userData) as User;\n\n      onLogin(user);\n    } catch (error) {\n      // Need to login\n    }\n  }, []);\n\n  const loadUser = async () => {\n    const user = await getUserByEmail(email);\n\n    if (user) {\n      saveUser(user);\n    } else {\n      setNeedToRegister(true);\n    }\n  };\n\n  const registerUser = () => {\n    return createUser({ name, email })\n      .then(saveUser);\n  };\n\n  const handleSubmit = async (event: React.FormEvent) => {\n    event.preventDefault();\n\n    setErrorMessage('');\n    setLoading(true);\n\n    try {\n      if (needToRegister) {\n        await registerUser();\n      } else {\n        await loadUser();\n      }\n    } catch (error) {\n      setErrorMessage('Something went wrtong');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  return (\n    <form onSubmit={handleSubmit} className=\"box mt-5\">\n      <h1 className=\"title is-3\">\n        {needToRegister ? 'You need to register' : 'Log in to open todos'}\n      </h1>\n\n      <div className=\"field\">\n        <label className=\"label\" htmlFor=\"user-email\">\n          Email\n        </label>\n\n        <div\n          className={classNames('control has-icons-left', {\n            'is-loading': loading,\n          })}\n        >\n          <input\n            type=\"email\"\n            id=\"user-email\"\n            className={classNames('input', {\n              'is-danger': !needToRegister && errorMessage,\n            })}\n            placeholder=\"Enter your email\"\n            disabled={loading || needToRegister}\n            value={email}\n            required\n            onChange={e => setEmail(e.target.value)}\n          />\n\n          <span className=\"icon is-small is-left\">\n            <i className=\"fas fa-envelope\" />\n          </span>\n        </div>\n\n        {!needToRegister && errorMessage && (\n          <p className=\"help is-danger\">{errorMessage}</p>\n        )}\n      </div>\n\n      {needToRegister && (\n        <div className=\"field\">\n          <label className=\"label\" htmlFor=\"user-name\">\n            Your Name\n          </label>\n\n          <div\n            className={classNames('control has-icons-left', {\n              'is-loading': loading,\n            })}\n          >\n            <input\n              type=\"text\"\n              id=\"user-name\"\n              className={classNames('input', {\n                'is-danger': needToRegister && errorMessage,\n              })}\n              placeholder=\"Enter your name\"\n              required\n              minLength={4}\n              disabled={loading}\n              value={name}\n              onChange={e => setName(e.target.value)}\n            />\n\n            <span className=\"icon is-small is-left\">\n              <i className=\"fas fa-user\" />\n            </span>\n          </div>\n\n          {needToRegister && errorMessage && (\n            <p className=\"help is-danger\">{errorMessage}</p>\n          )}\n        </div>\n      )}\n\n      <div className=\"field\">\n        <button\n          type=\"submit\"\n          className={classNames('button is-primary', {\n            'is-loading': loading,\n          })}\n        >\n          {needToRegister ? 'Register' : 'Login'}\n        </button>\n      </div>\n    </form>\n  );\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}