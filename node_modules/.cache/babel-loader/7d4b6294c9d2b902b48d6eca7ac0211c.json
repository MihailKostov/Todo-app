{"ast":null,"code":"var _jsxFileName = \"C:\\\\projects\\\\react_todo-app-with-api\\\\src\\\\App.tsx\",\n  _s = $RefreshSig$();\n/* eslint-disable jsx-a11y/control-has-associated-label */\nimport React, { useContext, useEffect, useRef, useState, useCallback, useMemo } from 'react';\nimport { postTodo, getTodos, deleteTodo } from './api/todos';\nimport { AuthContext } from './components/Auth/AuthContext';\nimport { TodoList } from './components/TodoList';\nimport { ErrorNotification } from './components/ErrorNotification';\nimport { FilterType } from './types/FilterType';\nimport { Footer } from './components/Footer';\nimport { ErrorMessage } from './types/ErrorMessage';\nimport { Header } from './components/Header';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nexport const App = () => {\n  _s();\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  const user = useContext(AuthContext);\n  const userId = (user === null || user === void 0 ? void 0 : user.id) || 0;\n  const newTodoField = useRef(null);\n  const [todos, setTodos] = useState([]);\n  const [visibleTodos, setVisibleTodos] = useState(todos);\n  const [filterType, setFilterType] = useState(FilterType.ALL);\n  const [isError, setIsError] = useState(ErrorMessage.none);\n  const [isAdding, setIsAdding] = useState(false);\n  const [processing, setProcessing] = useState([]);\n  const [tempTodo, setTempTodo] = useState({\n    id: 0,\n    userId,\n    title: '',\n    completed: false\n  });\n  const setTempTodoTitle = useCallback(title => {\n    return setTempTodo(prevTitle => ({\n      ...prevTitle,\n      title\n    }));\n  }, []);\n  const getTodoFromServer = async () => {\n    try {\n      const id = user ? user.id : 0;\n      const response = await getTodos(id);\n      setTodos(response);\n      setVisibleTodos(response);\n    } catch (error) {\n      setIsError(ErrorMessage.load);\n      setTimeout(() => {\n        setIsError(ErrorMessage.none);\n      }, 3000);\n    }\n  };\n  useEffect(() => {\n    getTodoFromServer();\n\n    // focus the element with `ref={newTodoField}`\n    if (newTodoField.current) {\n      newTodoField.current.focus();\n    }\n    getTodoFromServer();\n  }, []);\n  useEffect(() => {\n    const newVisibleTodos = todos.filter(todo => {\n      switch (filterType) {\n        case FilterType.ACTIVE:\n          return !todo.completed;\n        case FilterType.COMPLETED:\n          return todo.completed;\n        default:\n          return todo;\n      }\n    });\n    setVisibleTodos(newVisibleTodos);\n  }, [filterType, todos]);\n  const todosLeft = useMemo(() => {\n    return todos.reduce((num, todo) => {\n      if (!todo.completed) {\n        return num + 1;\n      }\n      return num;\n    }, 0);\n  }, [todos]);\n  const handleSubmit = useCallback(async event => {\n    event.preventDefault();\n    if (!tempTodo.title.trim()) {\n      setIsError(ErrorMessage.emptyTitle);\n      setTempTodoTitle('');\n      return;\n    }\n    setIsAdding(true);\n    try {\n      const newTodo = await postTodo(tempTodo.title, userId);\n      setTodos(prevTodos => [...prevTodos, newTodo]);\n    } catch (error) {\n      setIsError(ErrorMessage.add);\n    } finally {\n      setIsAdding(false);\n      setTempTodoTitle('');\n    }\n  }, [tempTodo, userId]);\n  const handleDelete = useCallback(async todoId => {\n    setProcessing(prevTodos => [...prevTodos, todoId]);\n    try {\n      await deleteTodo(todoId);\n      setTodos(prevTodos => prevTodos.filter(todo => todo.id !== todoId));\n    } catch (error) {\n      setIsError(ErrorMessage.delete);\n    } finally {\n      setProcessing(current => current.filter(id => id !== todoId));\n    }\n  }, []);\n  const handleUpdate = useCallback(async todoId => {});\n  const clearCompleted = useCallback(() => todos.forEach(todo => {\n    if (todo.completed) {\n      handleDelete(todo.id);\n    }\n  }), [todos]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"todoapp\",\n    children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n      className: \"todoapp__title\",\n      children: \"todos\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 155,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"todoapp__content\",\n      children: [/*#__PURE__*/_jsxDEV(Header, {\n        title: tempTodo.title,\n        hasTodos: todos.length > 0,\n        hasActiveTodos: todosLeft > 0,\n        isAdding: isAdding,\n        onSubmit: handleSubmit,\n        setTitle: setTempTodoTitle\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 158,\n        columnNumber: 9\n      }, this), todos.length > 0 && /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: [/*#__PURE__*/_jsxDEV(TodoList, {\n          todos: visibleTodos,\n          tempTodo: tempTodo,\n          isAdding: isAdding,\n          processing: processing,\n          onDelete: handleDelete\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 169,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(Footer, {\n          todosCount: todos.length,\n          todosLeft: todosLeft,\n          filterType: filterType,\n          setFilterType: setFilterType,\n          clearCompleted: clearCompleted\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 176,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 157,\n      columnNumber: 7\n    }, this), isError && /*#__PURE__*/_jsxDEV(ErrorNotification, {\n      error: isError,\n      onClose: () => setIsError(ErrorMessage.none)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 188,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 154,\n    columnNumber: 5\n  }, this);\n};\n_s(App, \"FA1HIFe8nMtmAY3bYZk0jlODAOQ=\");\n_c = App;\nvar _c;\n$RefreshReg$(_c, \"App\");","map":{"version":3,"names":["React","useContext","useEffect","useRef","useState","useCallback","useMemo","postTodo","getTodos","deleteTodo","AuthContext","TodoList","ErrorNotification","FilterType","Footer","ErrorMessage","Header","App","user","userId","id","newTodoField","todos","setTodos","visibleTodos","setVisibleTodos","filterType","setFilterType","ALL","isError","setIsError","none","isAdding","setIsAdding","processing","setProcessing","tempTodo","setTempTodo","title","completed","setTempTodoTitle","prevTitle","getTodoFromServer","response","error","load","setTimeout","current","focus","newVisibleTodos","filter","todo","ACTIVE","COMPLETED","todosLeft","reduce","num","handleSubmit","event","preventDefault","trim","emptyTitle","newTodo","prevTodos","add","handleDelete","todoId","delete","handleUpdate","clearCompleted","forEach","length"],"sources":["C:/projects/react_todo-app-with-api/src/App.tsx"],"sourcesContent":["/* eslint-disable jsx-a11y/control-has-associated-label */\nimport React, {\n  useContext,\n  useEffect,\n  useRef,\n  useState,\n  FormEvent,\n  useCallback,\n  useMemo,\n} from 'react';\n\nimport {\n  postTodo,\n  getTodos,\n  deleteTodo,\n  updateTodo,\n} from './api/todos';\n\nimport { AuthContext } from './components/Auth/AuthContext';\nimport { TodoList } from './components/TodoList';\nimport { ErrorNotification } from './components/ErrorNotification';\n\nimport { FilterType } from './types/FilterType';\nimport { Todo } from './types/Todo';\nimport { Footer } from './components/Footer';\nimport { ErrorMessage } from './types/ErrorMessage';\nimport { Header } from './components/Header';\n\nexport const App: React.FC = () => {\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  const user = useContext(AuthContext);\n  const userId = user?.id || 0;\n  const newTodoField = useRef<HTMLInputElement>(null);\n  const [todos, setTodos] = useState<Todo[]>([]);\n  const [visibleTodos, setVisibleTodos] = useState<Todo[]>(todos);\n  const [filterType, setFilterType] = useState(FilterType.ALL);\n  const [isError, setIsError] = useState<ErrorMessage>(ErrorMessage.none);\n  const [isAdding, setIsAdding] = useState(false);\n  const [processing, setProcessing] = useState<number[]>([]);\n  const [tempTodo, setTempTodo] = useState<Todo>({\n    id: 0,\n    userId,\n    title: '',\n    completed: false,\n  });\n\n  const setTempTodoTitle = useCallback((title: string) => {\n    return setTempTodo(prevTitle => (\n      {\n        ...prevTitle, title,\n      }));\n  }, []);\n\n  const getTodoFromServer = async () => {\n    try {\n      const id = user ? user.id : 0;\n      const response = await getTodos(id);\n\n      setTodos(response);\n      setVisibleTodos(response);\n    } catch (error) {\n      setIsError(ErrorMessage.load);\n\n      setTimeout(() => {\n        setIsError(ErrorMessage.none);\n      }, 3000);\n    }\n  };\n\n  useEffect(() => {\n    getTodoFromServer();\n\n    // focus the element with `ref={newTodoField}`\n    if (newTodoField.current) {\n      newTodoField.current.focus();\n    }\n\n    getTodoFromServer();\n  }, []);\n\n  useEffect(() => {\n    const newVisibleTodos = todos.filter(todo => {\n      switch (filterType) {\n        case FilterType.ACTIVE:\n          return !todo.completed;\n        case FilterType.COMPLETED:\n          return todo.completed;\n        default:\n          return todo;\n      }\n    });\n\n    setVisibleTodos(newVisibleTodos);\n  }, [filterType, todos]);\n\n  const todosLeft = useMemo(() => {\n    return todos.reduce((num, todo) => {\n      if (!todo.completed) {\n        return num + 1;\n      }\n\n      return num;\n    }, 0);\n  }, [todos]);\n\n  const handleSubmit = useCallback(async (event: FormEvent) => {\n    event.preventDefault();\n\n    if (!tempTodo.title.trim()) {\n      setIsError(ErrorMessage.emptyTitle);\n      setTempTodoTitle('');\n\n      return;\n    }\n\n    setIsAdding(true);\n\n    try {\n      const newTodo = await postTodo(tempTodo.title, userId);\n\n      setTodos(prevTodos => [...prevTodos, newTodo]);\n    } catch (error) {\n      setIsError(ErrorMessage.add);\n    } finally {\n      setIsAdding(false);\n      setTempTodoTitle('');\n    }\n  }, [tempTodo, userId]);\n\n  const handleDelete = useCallback(async (todoId: number) => {\n    setProcessing(prevTodos => [...prevTodos, todoId]);\n\n    try {\n      await deleteTodo(todoId);\n      setTodos(prevTodos => prevTodos.filter(todo => todo.id !== todoId));\n    } catch (error) {\n      setIsError(ErrorMessage.delete);\n    } finally {\n      setProcessing(current => current.filter(id => id !== todoId));\n    }\n  }, []);\n\n  const handleUpdate = useCallback(async (todoId: nu) => {\n    \n  })\n\n  const clearCompleted = useCallback(() => todos.forEach(todo => {\n    if (todo.completed) {\n      handleDelete(todo.id);\n    }\n  }), [todos]);\n\n  return (\n    <div className=\"todoapp\">\n      <h1 className=\"todoapp__title\">todos</h1>\n\n      <div className=\"todoapp__content\">\n        <Header\n          title={tempTodo.title}\n          hasTodos={todos.length > 0}\n          hasActiveTodos={todosLeft > 0}\n          isAdding={isAdding}\n          onSubmit={handleSubmit}\n          setTitle={setTempTodoTitle}\n        />\n\n        {todos.length > 0 && (\n          <>\n            <TodoList\n              todos={visibleTodos}\n              tempTodo={tempTodo}\n              isAdding={isAdding}\n              processing={processing}\n              onDelete={handleDelete}\n            />\n            <Footer\n              todosCount={todos.length}\n              todosLeft={todosLeft}\n              filterType={filterType}\n              setFilterType={setFilterType}\n              clearCompleted={clearCompleted}\n            />\n          </>\n        )}\n      </div>\n\n      {isError && (\n        <ErrorNotification\n          error={isError}\n          onClose={() => setIsError(ErrorMessage.none)}\n        />\n      )}\n\n    </div>\n  );\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}